//Global Variables
gcon,controllerAddr,65535,	//Binary: 11_1_1111111111111
gcon,LEDAddr,57343,		//Binary: 11_0_1111111111111
gcon,VGABaseAddr,32768,	//Binary: 10_00000000000000

//Initialization
addi,r3,r0,2439,		//Load initial block glyph position into r3
addi,r4,r0,1000,		//Put a max count used for waiting into r4
addi,r6,r0,VGABaseAddr,		//Load VGA base address into r6


//Game Loop
loop:
addi,r1,r0,controllerAddr,		//Load the controller address into r1
ld,r2,r1,0,   				//Load the controller value into r2
str,r2,r0,LEDAddr,			//Store the value to the LEDs

//Right			xxxx0001
//Left			xxxx0010
//Down			xxxx0100
//Up			xxxx1000
//Up-Right		xxxx1001
//UP-Left		xxxx1010
//Down-Right	xxxx0101
//Down-Left		xxxx0110

//Check Directions that are pressed. If so, check if the glyph is OK to move. Then move it.

andi,r5,r2,1,		//Put only the bits indicating direction into r5

checkR:
cmpi,x,r5,1,		//Check if direction pressed is right
bne,checkL:,		//Check next direction if check fails
addi,r7,r3,1,		//Put the glyph location we are trying to move to into r7
add,r7,r7,r6,		//Put the address to read from/write to the VGA into r7
ld,r8,r7,0,			//Load the glyph index of the glyph location we are trying to move to into r8
cmpi,x,r8,0,			//See if the location is valid
bne,wait:,			//Go to wait if location is invalid
add,r9,r3,r6,		//Load the location address of the current glyph position into r9.
ld,r10,r9,0,		//Load the glyph index of the current glyph location into r10.
str,r10,r7,0,		//Store the current glyph index into the future glyph position.
str,r0,r9,0,		//Make the glyph at the current glyph position black.
addi,r3,r3,1,		//update the variable that contains the current glyph position.

checkL:
checkD:
checkU:
checkUR:
checkUL:
checkDR:
checkDL:

//Wait
wait:
//addi,r23,r0,17,		//Debugging code.
//cmp,x,r4,r0,		//check to see if the counter is 0.
//subi,r4,r4,1,		//r4 = r4-1
//bne,wait:,		//if we're not done, branch to wait.
//addi,r4,r4,1000,	//r4 = 1000.
j,loop:
